/**
 * jscolor, JavaScript Color Picker
 *
 * @version 1.4.3
 * @license GNU Lesser General Public License, http://www.gnu.org/copyleft/lesser.html
 * @author  Jan Odvarko, http://odvarko.cz
 * @created 2008-06-15
 * @updated 2014-07-16
 * @link    http://jscolor.com
 * 
 * Added gloabal pseudonim for colorPicker. 
 * Compass Plus 2015
 * 
 */
$RWT.colorpicker={//set global object pseudonim
    install:function(a){var b=a.getAttribute("colorUpdate");null!=b&&(a.value=b.toUpperCase(),$(a).css("background-color",b),$(a).attr("colorUpdate",null));var c={dir:"",bindClass:"color",binding:!0,preloading:!0,install:function(){$(document).ready(c.init)},init:function(){c.binding&&c.bind(),c.preloading&&c.preload()},getDir:function(){return c.dir||(c.dir="images/"),c.dir},detectDir:function(){for(var a=location.href,b=document.getElementsByTagName("base"),d=0;d<b.length;d+=1)b[d].href&&(a=b[d].href);for(var b=document.getElementsByTagName("script"),d=0;d<b.length;d+=1)if(b[d].src&&/(^|\/)jscolor\.js([?#].*)?$/i.test(b[d].src)){var e=new c.URI(b[d].src),f=e.toAbsolute(a);return f.path=f.path.replace(/[^\/]+$/,""),f.query=null,f.fragment=null,f.toString()}return!1},bind:function(){for(var a=new RegExp("(^|\\s)("+c.bindClass+")(\\s*(\\{[^}]*\\})|\\s|$)","i"),b=document.getElementsByTagName("input"),d=0;d<b.length;d+=1){var e;if(!b[d].color&&b[d].className&&(e=b[d].className.match(a))){var f={};if(e[4])try{f=new Function("return ("+e[4]+")")()}catch(g){}b[d].color=new c.color(b[d],f)}}},preload:function(){for(var a in c.imgRequire)c.imgRequire.hasOwnProperty(a)&&c.loadImage(a)},images:{pad:[181,101],sld:[16,101],cross:[15,15],arrow:[7,11]},imgRequire:{},imgLoaded:{},requireImage:function(a){c.imgRequire[a]=!0},loadImage:function(a){c.imgLoaded[a]||(c.imgLoaded[a]=new Image,c.imgLoaded[a].src=c.getDir()+a)},fetchElement:function(a){return"string"===typeof a?document.getElementById(a):a},addEvent:function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)},fireEvent:function(a,b){if(a)if(document.createEvent){var c=document.createEvent("HTMLEvents");c.initEvent(b,!0,!0),a.dispatchEvent(c)}else if(document.createEventObject){var c=document.createEventObject();a.fireEvent("on"+b,c)}else a["on"+b]&&a["on"+b]()},getElementPos:function(a){var b=a,c=a,d=0,e=0;if(b.offsetParent)do d+=b.offsetLeft,e+=b.offsetTop;while(b=b.offsetParent);for(;(c=c.parentNode)&&"BODY"!==c.nodeName.toUpperCase();)d-=c.scrollLeft,e-=c.scrollTop;return[d,e]},getElementSize:function(a){return[a.offsetWidth,a.offsetHeight]},getRelMousePos:function(a){var b=0,c=0;return a||(a=window.event),"number"===typeof a.offsetX?(b=a.offsetX,c=a.offsetY):"number"===typeof a.layerX&&(b=a.layerX,c=a.layerY),{x:b,y:c}},getViewPos:function(){return"number"===typeof window.pageYOffset?[window.pageXOffset,window.pageYOffset]:document.body&&(document.body.scrollLeft||document.body.scrollTop)?[document.body.scrollLeft,document.body.scrollTop]:document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)?[document.documentElement.scrollLeft,document.documentElement.scrollTop]:[0,0]},getViewSize:function(){return"number"===typeof window.innerWidth?[window.innerWidth,window.innerHeight]:document.body&&(document.body.clientWidth||document.body.clientHeight)?[document.body.clientWidth,document.body.clientHeight]:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?[document.documentElement.clientWidth,document.documentElement.clientHeight]:[0,0]},URI:function(a){function b(a){for(var b="";a;)if("../"===a.substr(0,3)||"./"===a.substr(0,2))a=a.replace(/^\.+/,"").substr(1);else if("/./"===a.substr(0,3)||"/."===a)a="/"+a.substr(3);else if("/../"===a.substr(0,4)||"/.."===a)a="/"+a.substr(4),b=b.replace(/\/?[^\/]*$/,"");else if("."===a||".."===a)a="";else{var c=a.match(/^\/?[^\/]*/)[0];a=a.substr(c.length),b+=c}return b}this.scheme=null,this.authority=null,this.path="",this.query=null,this.fragment=null,this.parse=function(a){var b=a.match(/^(([A-Za-z][0-9A-Za-z+.-]*)(:))?((\/\/)([^\/?#]*))?([^?#]*)((\?)([^#]*))?((#)(.*))?/);return this.scheme=b[3]?b[2]:null,this.authority=b[5]?b[6]:null,this.path=b[7],this.query=b[9]?b[10]:null,this.fragment=b[12]?b[13]:null,this},this.toString=function(){var a="";return null!==this.scheme&&(a=a+this.scheme+":"),null!==this.authority&&(a=a+"//"+this.authority),null!==this.path&&(a+=this.path),null!==this.query&&(a=a+"?"+this.query),null!==this.fragment&&(a=a+"#"+this.fragment),a},this.toAbsolute=function(a){var a=new c.URI(a),d=this,e=new c.URI;return null===a.scheme?!1:(null!==d.scheme&&d.scheme.toLowerCase()===a.scheme.toLowerCase()&&(d.scheme=null),null!==d.scheme?(e.scheme=d.scheme,e.authority=d.authority,e.path=b(d.path),e.query=d.query):(null!==d.authority?(e.authority=d.authority,e.path=b(d.path),e.query=d.query):(""===d.path?(e.path=a.path,e.query=null!==d.query?d.query:a.query):("/"===d.path.substr(0,1)?e.path=b(d.path):(e.path=null!==a.authority&&""===a.path?"/"+d.path:a.path.replace(/[^\/]+$/,"")+d.path,e.path=b(e.path)),e.query=d.query),e.authority=a.authority),e.scheme=a.scheme),e.fragment=d.fragment,e)},a&&this.parse(a)},color:function(a,b){function e(a,b,c){var d=Math.min(Math.min(a,b),c),e=Math.max(Math.max(a,b),c),f=e-d;if(0===f)return[null,0,e];var g=a===d?3+(c-b)/f:b===d?5+(a-c)/f:1+(b-a)/f;return[6===g?0:g,f/e,e]}function f(a,b,c){if(null===a)return[c,c,c];var d=Math.floor(a),e=d%2?a-d:1-(a-d),f=c*(1-b),g=c*(1-b*e);switch(d){case 6:case 0:return[c,g,f];case 1:return[g,c,f];case 2:return[f,c,g];case 3:return[f,g,c];case 4:return[g,f,c];case 5:return[c,f,g]}}function g(){delete c.picker.owner,document.getElementsByTagName("body")[0].removeChild(c.picker.boxB)}function h(b,d){function v(){var a=r.pickerInsetColor.split(/\s+/),b=a.length<2?a[0]:a[1]+" "+a[0]+" "+a[0]+" "+a[1];h.btn.style.borderColor=b}if(!c.picker){c.picker={box:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div"),btn:document.createElement("div"),btnS:document.createElement("span"),btnT:document.createTextNode(r.pickerCloseText)};for(var e=0,f=4;e<c.images.sld[1];e+=f){var g=document.createElement("div");g.style.height=f+"px",g.style.fontSize="1px",g.style.lineHeight="0",c.picker.sld.appendChild(g)}c.picker.sldB.appendChild(c.picker.sld),c.picker.box.appendChild(c.picker.sldB),c.picker.box.appendChild(c.picker.sldM),c.picker.padB.appendChild(c.picker.pad),c.picker.box.appendChild(c.picker.padB),c.picker.box.appendChild(c.picker.padM),c.picker.btnS.appendChild(c.picker.btnT),c.picker.btn.appendChild(c.picker.btnS),c.picker.box.appendChild(c.picker.btn),c.picker.boxB.appendChild(c.picker.box)}var h=c.picker;if(h.box.onmouseup=h.box.onmouseout=function(){a.focus()},h.box.onmousedown=function(){t=!0},h.box.onmousemove=function(a){(w||x)&&(w&&o(a),x&&p(a),document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),q())},"ontouchstart"in window){var l=function(a){var b={offsetX:a.touches[0].pageX-y.X,offsetY:a.touches[0].pageY-y.Y};(w||x)&&(w&&o(b),x&&p(b),q()),a.stopPropagation(),a.preventDefault()};h.box.removeEventListener("touchmove",l,!1),h.box.addEventListener("touchmove",l,!1)}h.padM.onmouseup=h.padM.onmouseout=function(){w&&(w=!1,c.fireEvent(u,"change"))},h.padM.onmousedown=function(a){switch(s){case 0:0===r.hsv[2]&&r.fromHSV(null,null,1);break;case 1:0===r.hsv[1]&&r.fromHSV(null,1,null)}x=!1,w=!0,o(a),q()},"ontouchstart"in window&&h.padM.addEventListener("touchstart",function(a){y={X:a.target.offsetParent.offsetLeft,Y:a.target.offsetParent.offsetTop},this.onmousedown({offsetX:a.touches[0].pageX-y.X,offsetY:a.touches[0].pageY-y.Y})}),h.sldM.onmouseup=h.sldM.onmouseout=function(){x&&(x=!1,c.fireEvent(u,"change"))},h.sldM.onmousedown=function(a){w=!1,x=!0,p(a),q()},"ontouchstart"in window&&h.sldM.addEventListener("touchstart",function(a){y={X:a.target.offsetParent.offsetLeft,Y:a.target.offsetParent.offsetTop},this.onmousedown({offsetX:a.touches[0].pageX-y.X,offsetY:a.touches[0].pageY-y.Y})});var m=i(r);h.box.style.width=m[0]+"px",h.box.style.height=m[1]+"px",h.boxB.style.position="absolute",h.boxB.style.clear="both",h.boxB.style.left=b+"px",h.boxB.style.top=d+"px",h.boxB.style.zIndex=r.pickerZIndex,h.boxB.style.border=r.pickerBorder+"px solid",h.boxB.style.borderColor=r.pickerBorderColor,h.boxB.style.background=r.pickerFaceColor,h.pad.style.width=c.images.pad[0]+"px",h.pad.style.height=c.images.pad[1]+"px",h.padB.style.position="absolute",h.padB.style.left=r.pickerFace+"px",h.padB.style.top=r.pickerFace+"px",h.padB.style.border=r.pickerInset+"px solid",h.padB.style.borderColor=r.pickerInsetColor,h.padM.style.position="absolute",h.padM.style.left="0",h.padM.style.top="0",h.padM.style.width=r.pickerFace+2*r.pickerInset+c.images.pad[0]+c.images.arrow[0]+"px",h.padM.style.height=h.box.style.height,h.padM.style.cursor="crosshair",h.sld.style.overflow="hidden",h.sld.style.width=c.images.sld[0]+"px",h.sld.style.height=c.images.sld[1]+"px",h.sldB.style.display=r.slider?"block":"none",h.sldB.style.position="absolute",h.sldB.style.right=r.pickerFace+"px",h.sldB.style.top=r.pickerFace+"px",h.sldB.style.border=r.pickerInset+"px solid",h.sldB.style.borderColor=r.pickerInsetColor,h.sldM.style.display=r.slider?"block":"none",h.sldM.style.position="absolute",h.sldM.style.right="0",h.sldM.style.top="0",h.sldM.style.width=c.images.sld[0]+c.images.arrow[0]+r.pickerFace+2*r.pickerInset+"px",h.sldM.style.height=h.box.style.height;try{h.sldM.style.cursor="pointer"}catch(n){h.sldM.style.cursor="hand"}h.btn.style.display=r.pickerClosable?"block":"none",h.btn.style.position="absolute",h.btn.style.left=r.pickerFace+"px",h.btn.style.bottom=r.pickerFace+"px",h.btn.style.padding="0 15px",h.btn.style.height="18px",h.btn.style.border=r.pickerInset+"px solid",v(),h.btn.style.color=r.pickerButtonColor,h.btn.style.font="12px sans-serif",h.btn.style.textAlign="center";try{h.btn.style.cursor="pointer"}catch(n){h.btn.style.cursor="hand"}switch(h.btn.onmousedown=function(){r.hidePicker()},h.btnS.style.lineHeight=h.btn.style.height,s){case 0:var z="hs.png";break;case 1:var z="hv.png"}h.padM.style.backgroundImage="url('"+c.getDir()+"cross.gif')",h.padM.style.backgroundRepeat="no-repeat",h.sldM.style.backgroundImage="url('"+c.getDir()+"arrow.gif')",h.sldM.style.backgroundRepeat="no-repeat",h.pad.style.backgroundImage="url('"+c.getDir()+z+"')",h.pad.style.backgroundRepeat="no-repeat",h.pad.style.backgroundPosition="0 0",j(),k(),c.picker.owner=r,document.getElementsByTagName("body")[0].appendChild(h.boxB)}function i(a){var b=[2*a.pickerInset+2*a.pickerFace+c.images.pad[0]+(a.slider?2*a.pickerInset+2*c.images.arrow[0]+c.images.sld[0]:0),a.pickerClosable?4*a.pickerInset+3*a.pickerFace+c.images.pad[1]+a.pickerButtonHeight:2*a.pickerInset+2*a.pickerFace+c.images.pad[1]];return b}function j(){switch(s){case 0:var a=1;break;case 1:var a=2}var b=Math.round(r.hsv[0]/6*(c.images.pad[0]-1)),d=Math.round((1-r.hsv[a])*(c.images.pad[1]-1));c.picker.padM.style.backgroundPosition=r.pickerFace+r.pickerInset+b-Math.floor(c.images.cross[0]/2)+"px "+(r.pickerFace+r.pickerInset+d-Math.floor(c.images.cross[1]/2))+"px";var e=c.picker.sld.childNodes;switch(s){case 0:for(var g=f(r.hsv[0],r.hsv[1],1),h=0;h<e.length;h+=1)e[h].style.backgroundColor="rgb("+g[0]*(1-h/e.length)*100+"%,"+g[1]*(1-h/e.length)*100+"%,"+g[2]*(1-h/e.length)*100+"%)";break;case 1:var g,i,j=[r.hsv[2],0,0],h=Math.floor(r.hsv[0]),k=h%2?r.hsv[0]-h:1-(r.hsv[0]-h);switch(h){case 6:case 0:g=[0,1,2];break;case 1:g=[1,0,2];break;case 2:g=[2,0,1];break;case 3:g=[2,1,0];break;case 4:g=[1,2,0];break;case 5:g=[0,2,1]}for(var h=0;h<e.length;h+=1)i=1-1/(e.length-1)*h,j[1]=j[0]*(1-i*k),j[2]=j[0]*(1-i),e[h].style.backgroundColor="rgb("+100*j[g[0]]+"%,"+100*j[g[1]]+"%,"+100*j[g[2]]+"%)"}}function k(){switch(s){case 0:var a=2;break;case 1:var a=1}var b=Math.round((1-r.hsv[a])*(c.images.sld[1]-1));c.picker.sldM.style.backgroundPosition="0 "+(r.pickerFace+r.pickerInset+b-Math.floor(c.images.arrow[1]/2))+"px"}function l(){return c.picker&&c.picker.owner===r}function m(){u===a&&r.importColor(),r.pickerOnfocus&&r.hidePicker()}function n(){u!==a&&r.importColor()}function o(a){var b=c.getRelMousePos(a),d=b.x-r.pickerFace-r.pickerInset,e=b.y-r.pickerFace-r.pickerInset;switch(s){case 0:r.fromHSV(d*(6/(c.images.pad[0]-1)),1-e/(c.images.pad[1]-1),null,C);break;case 1:r.fromHSV(d*(6/(c.images.pad[0]-1)),null,1-e/(c.images.pad[1]-1),C)}}function p(a){var b=c.getRelMousePos(a),d=b.y-r.pickerFace-r.pickerInset;switch(s){case 0:r.fromHSV(null,null,1-d/(c.images.sld[1]-1),B);break;case 1:r.fromHSV(null,1-d/(c.images.sld[1]-1),null,B)}}function q(){if(r.onImmediateChange){var a;a="string"===typeof r.onImmediateChange?new Function(r.onImmediateChange):r.onImmediateChange,a.call(r)}}this.required=!0,this.adjust=!0,this.hash=!1,this.caps=!0,this.slider=!0,this.valueElement=a,this.styleElement=a,this.onImmediateChange=null,this.hsv=[0,0,1],this.rgb=[1,1,1],this.minH=0,this.maxH=6,this.minS=0,this.maxS=1,this.minV=0,this.maxV=1,this.pickerOnfocus=!0,this.pickerMode="HSV",this.pickerPosition="bottom",this.pickerSmartPosition=!0,this.pickerButtonHeight=20,this.pickerClosable=!1,this.pickerCloseText="Close",this.pickerButtonColor="ButtonText",this.pickerFace=10,this.pickerFaceColor="ThreeDFace",this.pickerBorder=1,this.pickerBorderColor="ThreeDHighlight ThreeDShadow ThreeDShadow ThreeDHighlight",this.pickerInset=1,this.pickerInsetColor="ThreeDShadow ThreeDHighlight ThreeDHighlight ThreeDShadow",this.pickerZIndex=1e4;for(var d in b)b.hasOwnProperty(d)&&(this[d]=b[d]);this.hidePicker=function(){l()&&g()},this.showPicker=function(){if(!l()){var j,k,m,b=c.getElementPos(a),d=c.getElementSize(a),e=c.getViewPos(),f=c.getViewSize(),g=i(this);switch(this.pickerPosition.toLowerCase()){case"left":j=1,k=0,m=-1;break;case"right":j=1,k=0,m=1;break;case"top":j=0,k=1,m=-1;break;default:j=0,k=1,m=1}var n=(d[k]+g[k])/2;if(this.pickerSmartPosition)var o=[-e[j]+b[j]+g[j]>f[j]&&-e[j]+b[j]+d[j]/2>f[j]/2&&b[j]+d[j]-g[j]>=0?b[j]+d[j]-g[j]:b[j],-e[k]+b[k]+d[k]+g[k]-n+n*m>f[k]?-e[k]+b[k]+d[k]/2>f[k]/2&&b[k]+d[k]-n-n*m>=0?b[k]+d[k]-n-n*m:b[k]+d[k]-n+n*m:b[k]+d[k]-n+n*m>=0?b[k]+d[k]-n+n*m:b[k]+d[k]-n-n*m];else var o=[b[j],b[k]+d[k]-n+n*m];h(o[j],o[k])}},this.importColor=function(){u?this.adjust?!this.required&&/^\s*$/.test(u.value)?(u.value="",v.style.backgroundImage=v.jscStyle.backgroundImage,v.style.backgroundColor=v.jscStyle.backgroundColor,v.style.color=v.jscStyle.color,this.exportColor(z|A)):this.fromString(u.value)||this.exportColor():this.fromString(u.value,z)||(v.style.backgroundImage=v.jscStyle.backgroundImage,v.style.backgroundColor=v.jscStyle.backgroundColor,v.style.color=v.jscStyle.color,this.exportColor(z|A)):this.exportColor()},this.exportColor=function(a){if(!(a&z)&&u){var b=this.toString();this.caps&&(b=b.toUpperCase()),this.hash&&(b="#"+b),u.value=b}a&A||!v||(v.style.backgroundImage="none",v.style.backgroundColor="#"+this.toString(),v.style.color=.213*this.rgb[0]+.715*this.rgb[1]+.072*this.rgb[2]<.5?"#FFF":"#000"),a&B||!l()||j(),a&C||!l()||k()},this.fromHSV=function(a,b,c,d){null!==a&&(a=Math.max(0,this.minH,Math.min(6,this.maxH,a))),null!==b&&(b=Math.max(0,this.minS,Math.min(1,this.maxS,b))),null!==c&&(c=Math.max(0,this.minV,Math.min(1,this.maxV,c))),this.rgb=f(null===a?this.hsv[0]:this.hsv[0]=a,null===b?this.hsv[1]:this.hsv[1]=b,null===c?this.hsv[2]:this.hsv[2]=c),this.exportColor(d)},this.fromRGB=function(a,b,c,d){null!==a&&(a=Math.max(0,Math.min(1,a))),null!==b&&(b=Math.max(0,Math.min(1,b))),null!==c&&(c=Math.max(0,Math.min(1,c)));var g=e(null===a?this.rgb[0]:a,null===b?this.rgb[1]:b,null===c?this.rgb[2]:c);null!==g[0]&&(this.hsv[0]=Math.max(0,this.minH,Math.min(6,this.maxH,g[0]))),0!==g[2]&&(this.hsv[1]=null===g[1]?null:Math.max(0,this.minS,Math.min(1,this.maxS,g[1]))),this.hsv[2]=null===g[2]?null:Math.max(0,this.minV,Math.min(1,this.maxV,g[2]));var h=f(this.hsv[0],this.hsv[1],this.hsv[2]);this.rgb[0]=h[0],this.rgb[1]=h[1],this.rgb[2]=h[2],this.exportColor(d)},this.fromString=function(a,b){var c=a.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i);return c?(6===c[1].length?this.fromRGB(parseInt(c[1].substr(0,2),16)/255,parseInt(c[1].substr(2,2),16)/255,parseInt(c[1].substr(4,2),16)/255,b):this.fromRGB(parseInt(c[1].charAt(0)+c[1].charAt(0),16)/255,parseInt(c[1].charAt(1)+c[1].charAt(1),16)/255,parseInt(c[1].charAt(2)+c[1].charAt(2),16)/255,b),!0):!1},this.toString=function(){return(256|Math.round(255*this.rgb[0])).toString(16).substr(1)+(256|Math.round(255*this.rgb[1])).toString(16).substr(1)+(256|Math.round(255*this.rgb[2])).toString(16).substr(1)};var r=this,s="hvs"===this.pickerMode.toLowerCase()?1:0,t=!1,u=c.fetchElement(this.valueElement),v=c.fetchElement(this.styleElement),w=!1,x=!1,y={},z=1,A=2,B=4,C=8;if(c.addEvent(a,"focus",function(){r.pickerOnfocus&&r.showPicker()}),c.addEvent(a,"blur",function(){t?t=!1:window.setTimeout(function(){t||m(),t=!1},0)}),u){var D=function(){r.fromString(u.value,z),q()};c.addEvent(u,"keyup",D),c.addEvent(u,"input",D),c.addEvent(u,"blur",n),u.setAttribute("autocomplete","off")}switch(v&&(v.jscStyle={backgroundImage:v.style.backgroundImage,backgroundColor:v.style.backgroundColor,color:v.style.color}),s){case 0:c.requireImage("hs.png");break;case 1:c.requireImage("hv.png")}c.requireImage("cross.gif"),c.requireImage("arrow.gif"),this.importColor()}};c.install()}};